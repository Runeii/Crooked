function resetScroll(){nav.classList.add("hide"),last_scroll=0}function animate_stage(){body.classList.add("sunrise"),setTimeout(function(){body.classList.add("daytime")},5e3)}function transitionAnimation(){$("#the_cans .image img").each(function(){$(this).css({height:$(this).height(),width:$(this).width()})}),target.parents().addClass("target_parent"),target.addClass("target_world"),body.classList.add("transition-start"),body.classList.remove("sunrise"),$(header).one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){!1===event_stop_one&&(event_stop_one=!0,body.classList.add("transition-setup"),target.parent().one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){!1===event_stop_two&&(event_stop_two=!0,body.classList.add("transitioning"),$(".target_parent > .world_info :last-child").one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){!1===event_stop_three&&(event_stop_three=!0,refreshElements())}))}))})}function refreshElements(){var a=$(target).attr("world"),b=worldData[a],c="";$.each(b,function(b,d){c+='<img src="'+wordpress.template_directory+d+'" id="'+a+"_"+b+'"/>'}),target.closest(".can").animate({opacity:0},{duration:1e3,start:function(){body.classList.remove("midnight","default","dayglo","mother"),body.classList.add(a)},complete:function(){switchWorld(a,c),event_stop_one=!1,event_stop_two=!1,event_stop_three=!1}})}function switchWorld(a,b){header.innerHTML=b,lede.innerHTML=worldData.copy[a].lede,introduction.innerHTML=worldData.copy[a].introduction,setupParallax(a,page_sunrise())}function setupParallax(){var a,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},d=worldData.layers[b],e=worldData[b];a="default"==b?"#":"#"+b+"_",$.each(d,function(b,c){for(var d=0,f=c.length;d<f;d++)$(a+c[d]).addClass("parallax_"+b),delete e[c[d]]}),$.each(e,function(b){$(a+b).addClass("parallax_five")}),parallax_one=$(".parallax_one"),parallax_two=$(".parallax_two"),parallax_three=$(".parallax_three"),parallax_four=$(".parallax_four"),parallax_five=$(".parallax_five"),setup_scroll(),c(b)}function setup_scroll(a){window.addEventListener("scroll",function(a){this_scroll=window.scrollY,this_scroll>=1.1*last_scroll?(nav.classList.add("hide"),last_scroll=this_scroll):this_scroll<=last_scroll/1.1&&(nav.classList.remove("hide"),last_scroll=this_scroll),ticking||window.requestAnimationFrame(function(){var a=-2*this_scroll;parallax_one.css({"margin-bottom":a/5+"px"}),parallax_two.css({"margin-bottom":a/4+"px"}),parallax_three.css({"margin-bottom":a/3+"px"}),parallax_four.css({"margin-bottom":a/2+"px"}),parallax_five.css({"margin-bottom":a+"px"}),ticking=!1}),ticking=!0})}function page_sunrise(a){resetScroll(),$("#header img").hide();$(window).scrollTop(0)||$("body").scrollTop(0);$("#the_cans .image img").each(function(){$(this).css({height:"inherit",width:"inherit"})}),body.classList.remove("transitioning","transition-setup","transition-start"),$(".target_parent").each(function(){$(this).removeClass("target_parent")}),$(".target_world").removeClass("target_world"),setTimeout(function(){$("#header img").fadeIn(3e3,function(){body.classList.add("sunrise")}),target.closest(".can").css({opacity:1}),transitioning=!1},500)}function getNavUrl(){return window.location.search.replace("?","")}function getParameters(a){var b={};a=a.toLowerCase(),a=a.split("&");for(var c=a.length,d=0;d<c;d++){var e=a[d].slice(0,a[d].search("=")),f=a[d].slice(a[d].search("=")).replace("=","");b[e]=f}return b}!function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();var passiveSupported=!1;try{var options=Object.defineProperty({},"passive",{get:function(){passiveSupported=!0}});window.addEventListener("test",null,options)}catch(a){}var body=document.body,nav=document.getElementById("nav"),header=document.getElementById("header"),sun=document.getElementById("sun"),lede=document.querySelector("#welcome .lede"),introduction=document.querySelector("#welcome .introduction"),parallax_one,parallax_two,parallax_three,parallax_four,parallax_five,transitioning=!1,swapping=!1,worldData,target,windowHeight=$(window).height(),event_stop_one=!1,event_stop_two=!1,event_stop_three=!1;console.log(wordpress.template_directory+"/worlds.json"),$.getJSON(wordpress.template_directory+"/worlds.json",function(a){console.log("Worlds loaded"),worldData=a,setupParallax(getParameters(getNavUrl()).world)});var last_scroll=windowHeight/100,ticking=!1;animate_stage(),$(".explore-button a").click(function(){return!1===transitioning&&(transitioning=!0,target=$("#"+this.getAttribute("target")),$("html, body").animate({scrollTop:target.offset().top-windowHeight/2+$("#the_cans").height()/2},1e3,function(){transitionAnimation()})),!1}),$('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function(a){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var b=$(this.hash);b=b.length?b:$("[name="+this.hash.slice(1)+"]"),b.length&&(a.preventDefault(),$("html, body").animate({scrollTop:b.offset().top},1e3,function(){var a=$(b);if(a.focus(),a.is(":focus"))return!1;a.attr("tabindex","-1"),a.focus()}))}});