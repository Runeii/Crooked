function launch_page(){$.getJSON(wordpress.template_directory+"/worlds.json",function(a){console.log("Worlds loaded"),worldData=a,setupParallax(getParameters(getNavUrl()).world),animate_stage()})}function resetScroll(){nav.classList.add("hide"),last_scroll=0}function animate_stage(){body.classList.add("sunrise"),setTimeout(function(){html.classList.add("daytime"),nav.classList.add("hide")},5500)}function transitionAnimation(){$("html, body").animate({scrollTop:image_parent.offset().top-windowHeight/2+image_parent.height()/2},1e3,function(){!1===event_stop_one&&(event_stop_one=!0,can_parent.css({width:can_parent.width(),left:can_parent.offset().left,top:"50%",transform:"translateY(-50%)",position:"fixed"}),html.classList.add("transition-move"),$("#the_cans").length?image_parent.one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){!1===event_stop_two&&(event_stop_two=!0,html.classList.add("transitioning"),can_parent.find(".loading").one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){!1===event_stop_three&&(event_stop_three=!0,refreshElements())}))}):!1===event_stop_two&&(event_stop_two=!0,html.classList.add("transitioning"),can_parent.find(".loading").one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){!1===event_stop_three&&(event_stop_three=!0,refreshElements())})))})}function refreshElements(){var a,b=$(target).attr("world"),c=worldData[b],d="";$.each(c,function(c,e){a="default"===b?c:b+"_"+c,Array.isArray(e)?d+='<picture id="'+a+'">\n                    <source\n                      media="all and (orientation: landscape)"\n                      srcset="'+wordpress.template_directory+e[0]+'">\n                    <source\n                      media="all and (orientation: portrait)"\n                      srcset="'+wordpress.template_directory+e[1]+'">\n                    <img\n                      src="'+wordpress.template_directory+e[1]+'">\n                  </picture>':d+='<picture id="'+a+'">\n                    <source\n                      media="all and (orientation: landscape)"\n                      srcset="'+wordpress.template_directory+e+'" class="landscape_only">\n                    <source\n                      media="all and (orientation: portrait)"\n                      srcset="'+wordpress.template_directory+'/assets/img/worlds/blank.gif">\n                    <img\n                      src="'+wordpress.template_directory+e+'" class="landscape_only">\n                  </picture>'}),target.animate({opacity:0},{duration:1e3,start:function(){body.classList.remove("midnight","default","dayglo","mother"),body.classList.add(b)},complete:function(){switchWorld(b,d),event_stop_one=!1,event_stop_two=!1,event_stop_three=!1}})}function switchWorld(a,b){header.innerHTML=b,lede.innerHTML=worldData.copy[a].lede,introduction.innerHTML=worldData.copy[a].introduction,Pace.restart(),Pace.once("done",function(){setupParallax(a),page_sunrise(a)})}function setupParallax(){var a,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",c=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],worldData.layers[b]),d=worldData[b];a="default"==b?"#":"#"+b+"_",$.each(c,function(b,c){for(var e=0,f=c.length;e<f;e++)$(a+c[e]+" img").addClass("parallax_"+b),delete d[c[e]]}),$.each(d,function(b){$(a+b+" img").addClass("parallax_five")}),parallax_one=$(".parallax_one"),parallax_two=$(".parallax_two"),parallax_three=$(".parallax_three"),parallax_four=$(".parallax_four"),parallax_five=$(".parallax_five"),setup_scroll(b)}function setup_scroll(a){window.addEventListener("scroll",function(a){this_scroll=window.scrollY,fix_header||(this_scroll>=1.1*last_scroll?(nav.classList.add("hide"),last_scroll=this_scroll):this_scroll<=last_scroll/1.1&&(nav.classList.remove("hide"),last_scroll=this_scroll)),ticking||window.requestAnimationFrame(function(){var a=1*this_scroll;parallax_one.css({transform:"translateY("+a/5+"px)"}),parallax_two.css({transform:"translateY("+a/4+"px)"}),parallax_three.css({transform:"translateY("+a/3+"px)"}),parallax_four.css({transform:"translateY("+a/2+"px)"}),parallax_five.css({transform:"translateY("+a+"px)"}),ticking=!1}),ticking=!0})}function page_sunrise(a){resetScroll(),$("#header img").hide();$(window).scrollTop(0)||$("body").scrollTop(0);$("#the_cans .image img").each(function(){$(this).css({height:"",width:""})}),can_parent.css({width:"",left:"",top:"",transform:"",position:""}),html.classList.remove("transitioning","transition-setup","transition-start","transition-move"),$(".target_parent").each(function(){$(this).removeClass("target_parent")}),$(".target_world").removeClass("target_world"),target.css({opacity:"1"}),$(".loading.button").removeClass("button"),setTimeout(function(){$("#header img").fadeIn(3e3,function(){body.classList.add("sunrise")}),can_parent.css({opacity:1}),transitioning=!1},500)}function getNavUrl(){return window.location.search.replace("?","")}function getParameters(a){var b={};a=a.toLowerCase(),a=a.split("&");for(var c=a.length,d=0;d<c;d++){var e=a[d].slice(0,a[d].search("=")),f=a[d].slice(a[d].search("=")).replace("=","");b[e]=f}return b}!function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();var passiveSupported=!1;try{var options=Object.defineProperty({},"passive",{get:function(){passiveSupported=!0}});window.addEventListener("test",null,options)}catch(a){}var html=document.documentElement,body=document.body,nav=document.getElementById("nav"),header=document.getElementById("header"),sun=document.getElementById("sun"),lede=document.querySelector("#welcome .lede"),introduction=document.querySelector("#welcome .introduction"),parallax_one,parallax_two,parallax_three,parallax_four,parallax_five,target,can_parent,image_parent,transitioning=!1,swapping=!1,worldData,fix_header,windowHeight=$(window).height(),windowWidth=$(window).width(),event_stop_one=!1,event_stop_two=!1,event_stop_three=!1,last_scroll=windowHeight/100,ticking=!1;$("#mobile-menu").click(function(){$(this).parent().toggleClass("open")}),$(".explore-button a").click(function(){return!1===transitioning&&(transitioning=!0,target=$("#"+this.getAttribute("target")),$("#the_cans .image img").each(function(){$(this).css({height:$(this).height(),width:$(this).width()})}),target.parents().addClass("target_parent"),target.addClass("target_world"),html.classList.add("transition-start"),body.classList.remove("sunrise"),can_parent=$(".can.target_parent"),image_parent=$(".image.target_parent"),$(header).one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(a){transitionAnimation()})),!1}),$('a[href*="#"]').not('[href="#"]').click(function(a){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var b=$(this.hash);b=b.length?b:$("[name="+this.hash.slice(1)+"]"),b.length&&(a.preventDefault(),fix_header=!0,$("html, body").animate({scrollTop:b.offset().top-$("#nav").height()},1e3,function(){fix_header=!1,nav.classList.remove("hide"),last_scroll=window.scrollY}))}});